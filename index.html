<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Woningen en geiten in Deventer — Follow the Money</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@700;800;900&family=Inter:wght@400;500;600&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ftm-rood: #FF5725;
            --ftm-zwart: #000000;
            --ftm-offwhite: #F5F1ED;
            --ftm-goud: #B39956;
            --ftm-zilver: #A19B89;
            --ftm-dollargroen: #706F5F;
            --ftm-blauw: #0067AF;
            --ftm-roze: #B0279C;
            --ftm-geel: #D4A535;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
            background: var(--ftm-offwhite);
            color: var(--ftm-zwart);
        }

        .header {
            background: var(--ftm-zwart);
            color: white;
            padding: 20px 28px;
        }

        .header-brand {
            font-family: 'Barlow Condensed', 'Arial Narrow', sans-serif;
            font-weight: 800;
            font-size: 13px;
            letter-spacing: 2.5px;
            text-transform: uppercase;
            color: var(--ftm-zilver);
            margin-bottom: 6px;
        }

        .header-title {
            font-family: 'Barlow Condensed', 'Arial Narrow', sans-serif;
            font-weight: 900;
            font-size: 32px;
            line-height: 1.1;
            color: white;
        }

        .header-subtitle {
            font-family: 'Inter', sans-serif;
            font-weight: 400;
            font-size: 14px;
            color: var(--ftm-zilver);
            margin-top: 10px;
            max-width: 640px;
            line-height: 1.5;
        }

        .header-subtitle strong {
            color: var(--ftm-rood);
            font-weight: 600;
        }

        #map {
            width: 100%;
            height: calc(100vh - 140px);
            min-height: 500px;
        }

        /* Legend */
        .legend {
            background: white;
            padding: 16px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
            font-family: 'Inter', sans-serif;
            font-size: 12.5px;
            line-height: 1.5;
            max-width: 280px;
        }

        .legend-title {
            font-family: 'Barlow Condensed', sans-serif;
            font-weight: 800;
            font-size: 15px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 7px;
        }

        .legend-swatch {
            width: 22px;
            height: 14px;
            margin-right: 10px;
            flex-shrink: 0;
            border: 2px solid;
        }

        .legend-circle {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            margin-right: 10px;
            margin-left: 4px;
            flex-shrink: 0;
        }

        .legend-dashed {
            width: 22px;
            height: 0;
            border-top: 2.5px dashed var(--ftm-rood);
            margin-right: 10px;
            flex-shrink: 0;
        }

        .legend-meta {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--ftm-zilver);
            margin-top: 12px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }

        /* Popups */
        .leaflet-popup-content-wrapper {
            border-radius: 0;
            box-shadow: 0 3px 14px rgba(0,0,0,0.2);
            font-family: 'Inter', sans-serif;
        }

        .leaflet-popup-content {
            margin: 14px 18px;
            font-size: 13px;
            line-height: 1.4;
        }

        .leaflet-popup-tip {
            box-shadow: none;
        }

        .popup-label {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 2px;
        }

        .popup-title {
            font-family: 'Barlow Condensed', sans-serif;
            font-weight: 800;
            font-size: 20px;
        }

        .popup-detail {
            font-size: 12px;
            color: #555;
            margin-top: 4px;
        }

        /* Layer control styling */
        .leaflet-control-layers {
            border-radius: 0 !important;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
        }

        /* Circle label */
        .radius-label {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            font-weight: 700;
            color: var(--ftm-rood);
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(255,255,255,0.85);
            padding: 2px 8px;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-brand">Follow the Money</div>
        <div class="header-title">Woningen en geiten in Deventer</div>
        <div class="header-subtitle">
            Binnen 1 kilometer van deze geitenhouderij zijn al 400 woningen gebouwd.
            Als drie andere bouwplannen doorgaan, komen daar nog <strong>2.440 woningen</strong> bij.
        </div>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // =============================================
        // FTM COLOR PALETTE
        // =============================================
        const C = {
            blauw:       '#0067AF',
            roze:        '#B0279C',
            geel:        '#D4A535',
            rood:        '#FF5725',
            zwart:       '#000000',
            dollargroen: '#706F5F',
            offwhite:    '#F5F1ED',
            zilver:      '#A19B89'
        };

        // =============================================
        // MAP INITIALIZATION
        // =============================================
        const map = L.map('map', {
            zoomControl: true,
            attributionControl: true
        });

        // Basemap: CartoDB Positron (clean, minimal)
        const positron = L.tileLayer(
            'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> &copy; <a href="https://carto.com/">CARTO</a>',
            maxZoom: 19
        });

        // Satellite: Esri World Imagery
        const satellite = L.tileLayer(
            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: '&copy; Esri',
            maxZoom: 19
        });

        positron.addTo(map);

        L.control.layers(
            { 'Kaart': positron, 'Satelliet': satellite },
            null,
            { position: 'topright' }
        ).addTo(map);

        // =============================================
        // GOAT FARM LOCATION (main subject)
        // =============================================
        const GOAT_FARM = [52.2742744, 6.1801997];

        // =============================================
        // POLYGONS
        // =============================================

        // Agricultural area boundary (subtle background)
        const landbouwgebied = L.polygon([
            [52.2764651, 6.1791706],
            [52.2719222, 6.1767888],
            [52.2726575, 6.181252],
            [52.2722636, 6.1897492],
            [52.272001,  6.1944055],
            [52.2722242, 6.197195],
            [52.2754442, 6.1963759],
            [52.276954,  6.1973415],
            [52.2777417, 6.1911402],
            [52.2762582, 6.183158],
            [52.2761368, 6.1803722],
            [52.2764651, 6.1791706]
        ], {
            color: C.zwart,
            weight: 1.2,
            fillColor: C.zwart,
            fillOpacity: 0.04,
            dashArray: '4,4',
            interactive: false
        });

        // 400 woningen — BLAUW (reeds gebouwd)
        const woningen400 = L.polygon([
            [52.2786201, 6.1672178],
            [52.2777274, 6.1673895],
            [52.2772547, 6.1659732],
            [52.2754692, 6.1676469],
            [52.2752329, 6.1698142],
            [52.2743795, 6.1693636],
            [52.2743926, 6.1722818],
            [52.2776617, 6.173462],
            [52.2783313, 6.1702219],
            [52.2786201, 6.1672178]
        ], {
            color: C.blauw,
            weight: 3,
            fillColor: C.blauw,
            fillOpacity: 0.25
        }).bindPopup(`
            <div class="popup-label" style="color:${C.blauw}">Reeds gebouwd</div>
            <div class="popup-title">400 woningen</div>
        `);

        // 800 woningen — ROZE (wordt nu gebouwd)
        const woningen800 = L.polygon([
            [52.2776617, 6.173462],
            [52.277302,  6.1763947],
            [52.2797701, 6.1776822],
            [52.2807153, 6.1705368],
            [52.2801509, 6.1703222],
            [52.2804397, 6.1678117],
            [52.2787068, 6.1671679],
            [52.2784442, 6.1701505],
            [52.2776617, 6.173462]
        ], {
            color: C.roze,
            weight: 3,
            fillColor: C.roze,
            fillOpacity: 0.22
        }).bindPopup(`
            <div class="popup-label" style="color:${C.roze}">Wordt nu gebouwd</div>
            <div class="popup-title">800 woningen</div>
        `);

        // 1.600 woningen — GEEL (moet nog gebouwd worden)
        const woningen1600 = L.polygon([
            [52.2762582, 6.17936],
            [52.2739343, 6.1783729],
            [52.2736454, 6.1967192],
            [52.2754442, 6.1963759],
            [52.276954,  6.1973415],
            [52.2777417, 6.1911402],
            [52.2771115, 6.1872993],
            [52.2762582, 6.183158],
            [52.2762582, 6.17936]
        ], {
            color: C.geel,
            weight: 3,
            fillColor: C.geel,
            fillOpacity: 0.25
        }).bindPopup(`
            <div class="popup-label" style="color:${C.geel}">Moet nog gebouwd worden</div>
            <div class="popup-title">1.600 woningen</div>
        `);

        // 40 woningen — GEEL (moet nog gebouwd worden)
        const woningen40 = L.polygon([
            [52.2710481, 6.1865383],
            [52.2699887, 6.1868674],
            [52.269978,  6.1879484],
            [52.2704245, 6.1883829],
            [52.2711852, 6.1883922],
            [52.2710481, 6.1865383]
        ], {
            color: C.geel,
            weight: 3,
            fillColor: C.geel,
            fillOpacity: 0.25
        }).bindPopup(`
            <div class="popup-label" style="color:${C.geel}">Moet nog gebouwd worden</div>
            <div class="popup-title">40 woningen</div>
        `);

        // =============================================
        // 1 KM RADIUS CIRCLE
        // =============================================
        const cirkel1km = L.circle(GOAT_FARM, {
            radius: 1000,
            color: C.rood,
            weight: 2.5,
            fillColor: C.rood,
            fillOpacity: 0.04,
            dashArray: '12,8'
        }).bindPopup(`
            <div class="popup-label" style="color:${C.rood}">Risicozone</div>
            <div class="popup-title">1 km afstandsgrens</div>
            <div class="popup-detail">Voorgestelde grens vanwege verhoogd risico op longontsteking nabij geitenhouderijen</div>
        `);

        // Label on circle perimeter (top)
        const cirkelLabel = L.marker(
            [GOAT_FARM[0] + 0.009, GOAT_FARM[1]], {
            icon: L.divIcon({
                className: '',
                html: '<div class="radius-label">1 km</div>',
                iconSize: [50, 20],
                iconAnchor: [25, 10]
            }),
            interactive: false
        });

        // =============================================
        // FARM MARKERS
        // =============================================
        function farmIcon(color, size) {
            return L.divIcon({
                className: '',
                html: `<div style="
                    width:${size}px; height:${size}px;
                    background:${color};
                    border-radius:50%;
                    border:2.5px solid white;
                    box-shadow: 0 1px 5px rgba(0,0,0,0.35);
                "></div>`,
                iconSize: [size, size],
                iconAnchor: [size/2, size/2]
            });
        }

        const geiten = L.marker(GOAT_FARM, { icon: farmIcon(C.rood, 22), zIndexOffset: 1000 })
            .bindPopup(`
                <div class="popup-label" style="color:${C.rood}">Geitenhouderij</div>
                <div class="popup-title">1.409 geiten</div>
                <div class="popup-detail">Verhoogd risico op longontsteking binnen 1 km</div>
            `);

        const varkens = L.marker([52.2772935, 6.1886441], { icon: farmIcon(C.dollargroen, 18) })
            .bindPopup(`
                <div class="popup-label" style="color:${C.dollargroen}">Varkenshouderij</div>
                <div class="popup-title">1.895 varkens</div>
            `);

        const koeien = L.marker([52.2759297, 6.192552], { icon: farmIcon(C.dollargroen, 18) })
            .bindPopup(`
                <div class="popup-label" style="color:${C.dollargroen}">Melkveehouderij</div>
                <div class="popup-title">102 melkkoeien</div>
            `);

        // =============================================
        // AREA LABELS
        // =============================================
        function areaLabel(latlng, text, color) {
            return L.marker(latlng, {
                icon: L.divIcon({
                    className: '',
                    html: `<div style="
                        font-family:'Barlow Condensed',sans-serif;
                        font-weight:800;
                        font-size:14px;
                        color:${color};
                        text-shadow:
                            1px 1px 3px rgba(255,255,255,0.9),
                            -1px -1px 3px rgba(255,255,255,0.9),
                            2px 0 3px rgba(255,255,255,0.9),
                            0 2px 3px rgba(255,255,255,0.9);
                        white-space:nowrap;
                        letter-spacing:0.5px;
                    ">${text}</div>`,
                    iconSize: [140, 18],
                    iconAnchor: [70, 9]
                }),
                interactive: false
            });
        }

        function farmLabel(latlng, text, color) {
            return L.marker(latlng, {
                icon: L.divIcon({
                    className: '',
                    html: `<div style="
                        font-family:'Space Mono',monospace;
                        font-size:10px;
                        font-weight:700;
                        color:${color};
                        text-transform:uppercase;
                        letter-spacing:1px;
                        text-shadow:
                            1px 1px 2px rgba(255,255,255,0.9),
                            -1px -1px 2px rgba(255,255,255,0.9);
                        white-space:nowrap;
                    ">${text}</div>`,
                    iconSize: [120, 14],
                    iconAnchor: [60, -6]
                }),
                interactive: false
            });
        }

        // =============================================
        // ADD ALL LAYERS TO MAP
        // =============================================
        landbouwgebied.addTo(map);
        cirkel1km.addTo(map);
        woningen400.addTo(map);
        woningen800.addTo(map);
        woningen1600.addTo(map);
        woningen40.addTo(map);
        geiten.addTo(map);
        varkens.addTo(map);
        koeien.addTo(map);
        cirkelLabel.addTo(map);

        // Area labels
        areaLabel([52.2766, 6.1695], '400 woningen', C.blauw).addTo(map);
        areaLabel([52.2797, 6.1728], '800 woningen', C.roze).addTo(map);
        areaLabel([52.2758, 6.1885], '1.600 woningen', C.geel).addTo(map);
        areaLabel([52.2706, 6.1876], '40 won.', C.geel).addTo(map);

        // Farm labels
        farmLabel([52.2742744, 6.1801997], '1.409 geiten', C.rood).addTo(map);
        farmLabel([52.2772935, 6.1886441], '1.895 varkens', C.dollargroen).addTo(map);
        farmLabel([52.2759297, 6.192552], '102 melkkoeien', C.dollargroen).addTo(map);

        // =============================================
        // FIT BOUNDS
        // =============================================
        const allBounds = L.latLngBounds(cirkel1km.getBounds());
        allBounds.extend(woningen400.getBounds());
        allBounds.extend(woningen800.getBounds());
        map.fitBounds(allBounds.pad(0.08));

        // =============================================
        // LEGEND
        // =============================================
        const legend = L.control({ position: 'bottomleft' });
        legend.onAdd = function() {
            const div = L.DomUtil.create('div', 'legend');
            div.innerHTML = `
                <div class="legend-title">Legenda</div>
                <div class="legend-item">
                    <div class="legend-swatch" style="background:${C.blauw}40; border-color:${C.blauw};"></div>
                    <span>Reeds gebouwd (400)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-swatch" style="background:${C.roze}38; border-color:${C.roze};"></div>
                    <span>Wordt nu gebouwd (800)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-swatch" style="background:${C.geel}40; border-color:${C.geel};"></div>
                    <span>Nog te bouwen (1.640)</span>
                </div>
                <div class="legend-item" style="margin-top:4px;">
                    <div class="legend-dashed"></div>
                    <span>1 km risicozone</span>
                </div>
                <div class="legend-item">
                    <div class="legend-circle" style="background:${C.rood};"></div>
                    <span>Geitenhouderij</span>
                </div>
                <div class="legend-item">
                    <div class="legend-circle" style="background:${C.dollargroen};"></div>
                    <span>Overige veehouderij</span>
                </div>
                <div class="legend-meta">
                    Bron: FTM / Omroep Gelderland / NRC
                </div>
            `;
            return div;
        };
        legend.addTo(map);
    </script>
</body>
</html>
